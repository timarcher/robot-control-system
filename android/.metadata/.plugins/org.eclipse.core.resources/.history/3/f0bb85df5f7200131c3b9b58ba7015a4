package com.timarcher.robotface;

import java.util.Locale;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.speech.tts.TextToSpeech;
import android.util.Log;
import android.view.Menu;
import android.widget.Toast;

public class MainActivity extends Activity implements TextToSpeech.OnInitListener {
    private static final String TAG = "SpeechActivity";
    private TextToSpeech tts;
    
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		
		//Check for the TTS library
        //Intent checkIntent = new Intent();
        //checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
        //startActivityForResult(checkIntent, 0);
        
		Log.i(TAG, "onCreateCalled.");
		tts = new TextToSpeech(this, this);
		
	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}

	/**
	 * Overridden method to initialize the text to speech engine
	 * 
	 * @param status
	 */
    @Override
    public void onInit(int status) {
    	Log.i(TAG, "onInit Called. Status:" + status);

		// Now that the TTS engine is ready, we enable the button
        if (status == TextToSpeech.SUCCESS) {
        	int result = tts.setLanguage(Locale.US);
        	
    		//
    		//By default the value is 1.0 You can set lower values than 1.0 to decrease pitch 
    		//level or greater values for increase pitch level.
    		//
    		tts.setPitch(0.6f);
    		
    		//
    		//The speed rate can be set using setSpeechRate(). This also will take default 
    		//of 1.0 value. You can double the speed rate by setting 2.0 or make half the speed level by setting 0.5
    		//
    		tts.setSpeechRate(2f);        	
            if (result == TextToSpeech.LANG_MISSING_DATA
                    || result == TextToSpeech.LANG_NOT_SUPPORTED) {
                Log.e(TAG, "This Language is not supported");
            } else {
            	sayIt("Hello from Android! How are you today? ");
            }
            
        }
        else {
        	Log.e(TAG, "TTS Initilization Failed");
        }
        
        Toast.makeText(getBaseContext(), 
                "TTS onInit Called. Status:"+status, 
                Toast.LENGTH_SHORT).show();         
    }
    
    /**
     * Shutdown TTS
     */
    @Override
    public void onDestroy() {
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    }
    
    /**
     * Method to say the text provided.
     * @param text
     */
    protected void sayIt (String text) {
    	tts.speak(text, TextToSpeech.QUEUE_FLUSH, null);    	
    }
}
